!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.ajax=factory()}(this,function(){"use strict";function decode(input){return decodeURIComponent(input.replace(/\+/g," "))}function isObjectObject(o){return!0===isobject(o)&&"[object Object]"===Object.prototype.toString.call(o)}function assign(a,b){for(var key in b)(function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)})(b,key)&&(a[key]=b[key])}var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},window_1="undefined"!=typeof window?window:void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:{},has=Object.prototype.hasOwnProperty,querystringify_1={stringify:function(obj,prefix){var pairs=[];"string"!=typeof(prefix=prefix||"")&&(prefix="?");for(var key in obj)has.call(obj,key)&&pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(obj[key]));return pairs.length?prefix+pairs.join("&"):""},parse:function(query){for(var part,parser=/([^=?&]+)=?([^&]*)/g,result={};part=parser.exec(query);result[decode(part[1])]=decode(part[2]));return result}},isobject=function(val){return null!=val&&"object"==typeof val&&!1===Array.isArray(val)},isExtendable=function(val){return function(o){var ctor,prot;return!1!==isObjectObject(o)&&"function"==typeof(ctor=o.constructor)&&(prot=ctor.prototype,!1!==isObjectObject(prot)&&!1!==prot.hasOwnProperty("isPrototypeOf"))}(val)||"function"==typeof val||Array.isArray(val)},extendShallow=Object.assign||function(obj){if(null===obj||void 0===obj)throw new TypeError("expected an object");for(var i=1;i<arguments.length;i++){var val=arguments[i];(function(val){return val&&"object"==typeof val||isExtendable(val)})(val)&&assign(obj,val)}return obj},defaults={url:"",headers:{},data:{},method:"GET",cache:!0},optionalProperties=["responseType","withCredentials","timeout","onprogress"];return function(opts){return new Promise(function(resolve,reject){"string"==typeof opts&&(opts=extendShallow({},defaults,{url:opts}));var options=extendShallow({},defaults,opts),headers=extendShallow({"X-RequestedWith":"XMLHttpRequest"},options.headers),isGet="get"===options.method.toLowerCase(),cacheOption={},data=void 0;isGet?(options.cache||(cacheOption._=Date.now()),data=extendShallow({},options.data,cacheOption)):data=options.data;var url=options.url,req=function(cors){var nav=window_1.navigator||"";return cors&&window_1.XDomainRequest&&!/MSIE 1/.test(nav.userAgent)?new XDomainRequest:new XMLHttpRequest}(options.cors);if(isGet&&Object.keys(data).length){var qs=querystringify_1.stringify(data);url=-1===url.indexOf("?")?url+"?"+qs:url+"&"+qs}req.open(options.method,url,!0);for(var i=0,len=optionalProperties.length;i<len;i++){var field=optionalProperties[i];void 0!==options[field]&&(req[field]=options[field])}for(var _field in headers)req.setRequestHeader(_field,headers[_field]);req.onload=function(){var outData=function(req){return req.responseType?req.response:-1!==(req.getResponseHeader("content-type")||"").indexOf("application/json")?JSON.parse(req.responseText):req.responseText}(req);req.status>=200&&req.status<300?resolve({data:outData,status:"Success",xhr:req}):reject({data:outData,status:req.statusText,xhr:req})},req.onerror=function(){reject({data:"Error",status:req.statusText,xhr:req})},req.ontimeout=function(){reject({data:"Timeout",status:req.statusText,xhr:req})},req.onabort=function(){reject({data:"Abort",status:req.statusText,xhr:req})},req.send(data)})}});
